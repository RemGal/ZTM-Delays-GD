package com.example.lasthope;

import androidx.appcompat.app.AppCompatActivity;
import androidx.appcompat.widget.AppCompatImageButton;
import androidx.appcompat.widget.AppCompatTextView;
import androidx.appcompat.widget.SwitchCompat;
import androidx.appcompat.widget.Toolbar;

import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.CompoundButton;
import android.widget.TextView;

import com.example.lasthope.model.Vehicle;
import com.example.lasthope.util.Constants;
import com.example.lasthope.util.JSONDeserializer;
import com.example.lasthope.util.JSONReader;
import com.example.lasthope.util.MapOverlayPrinter;

import org.osmdroid.api.IMapController;
import org.osmdroid.config.Configuration;
import org.osmdroid.tileprovider.tilesource.TileSourceFactory;
import org.osmdroid.util.GeoPoint;
import org.osmdroid.views.MapView;

public class VehicleTrackerActivity extends AppCompatActivity {


    Toolbar toolbar;
    AppCompatTextView stopTextView;
    SwitchCompat themeSwitch;
    AppCompatImageButton activityButton;

    JSONReader reader;
    JSONDeserializer deserializer;

    Vehicle trackedVehicle;

    MapView map;
    MapOverlayPrinter mapOverlayPrinter;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if (getIntent().getBooleanExtra(new Constants().getSWITCH_STATE(),false)) {setTheme(R.style.AppThemeD);}
        setContentView(R.layout.activity_vehicle_tracker);


        toolbar = (Toolbar) findViewById(R.id.toolbar);
        setSupportActionBar(toolbar);
        getSupportActionBar().setDisplayShowTitleEnabled(false);

        stopTextView = (AppCompatTextView) toolbar.findViewById(R.id.toolbar_title);
        themeSwitch = (SwitchCompat) toolbar.findViewById(R.id.toolbar_switch);
        activityButton = (AppCompatImageButton) toolbar.findViewById(R.id.toolbar_imgbutton);

        reader = new JSONReader(getApplicationContext());
        deserializer = new JSONDeserializer();

        trackedVehicle = deserializer.getVehicle(getIntent().getIntExtra(new Constants().getVEHICLE_CODE(),0), "{\"LastUpdateData\":\"2020-01-18 16:46:34\",\"Vehicles\":[{\"DataGenerated\":\"2020-01-18 16:46:24\",\"Line\":\"149\",\"Route\":\"31\",\"VehicleCode\":\"8401\",\"VehicleService\":\"149-02\",\"VehicleId\":145674,\"Speed\":5,\"Delay\":21,\"Lat\":54.38124084472656,\"Lon\":18.604049682617188,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:23\",\"Line\":\"167\",\"Route\":\"32\",\"VehicleCode\":\"2660\",\"VehicleService\":\"167-03\",\"VehicleId\":145593,\"Speed\":40,\"Delay\":62,\"Lat\":54.35784912109375,\"Lon\":18.491010665893555,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:33\",\"Line\":\"169\",\"Route\":\"31\",\"VehicleCode\":\"2532\",\"VehicleService\":\"169-04\",\"VehicleId\":198,\"Speed\":15,\"Delay\":-87,\"Lat\":54.398128509521484,\"Lon\":18.48533058166504,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:25\",\"Line\":\"9\",\"Route\":\"112\",\"VehicleCode\":\"1117\",\"VehicleService\":\"009-04\",\"VehicleId\":398,\"Speed\":15,\"Delay\":11,\"Lat\":54.37614822387695,\"Lon\":18.614599227905273,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"175\",\"Route\":\"71\",\"VehicleCode\":\"2746\",\"VehicleService\":\"175-04\",\"VehicleId\":145603,\"Speed\":0,\"Delay\":142,\"Lat\":54.31990051269531,\"Lon\":18.593809127807617,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:23\",\"Line\":\"2\",\"Route\":\"11\",\"VehicleCode\":\"1030\",\"VehicleService\":\"002-05\",\"VehicleId\":424,\"Speed\":0,\"Delay\":0,\"Lat\":54.40980911254883,\"Lon\":18.567380905151367,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:18\",\"Line\":\"911\",\"Route\":\"101\",\"VehicleCode\":\"2734\",\"VehicleService\":\"911-01\",\"VehicleId\":465,\"Speed\":0,\"Delay\":17,\"Lat\":54.350128173828125,\"Lon\":18.645809173583984,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"111\",\"Route\":\"11\",\"VehicleCode\":\"2736\",\"VehicleService\":\"111-04\",\"VehicleId\":467,\"Speed\":20,\"Delay\":-71,\"Lat\":54.36003875732422,\"Lon\":18.72052001953125,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:33\",\"Line\":\"154\",\"Route\":\"21\",\"VehicleCode\":\"2679\",\"VehicleService\":\"154-01\",\"VehicleId\":145732,\"Speed\":40,\"Delay\":58,\"Lat\":54.35578155517578,\"Lon\":18.64539909362793,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:26\",\"Line\":\"8\",\"Route\":\"11\",\"VehicleCode\":\"1038\",\"VehicleService\":\"008-03\",\"VehicleId\":444,\"Speed\":0,\"Delay\":-33,\"Lat\":54.38970184326172,\"Lon\":18.608489990234375,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"8\",\"Route\":\"12\",\"VehicleCode\":\"1032\",\"VehicleService\":\"008-07\",\"VehicleId\":426,\"Speed\":35,\"Delay\":-91,\"Lat\":54.3590087890625,\"Lon\":18.647689819335938,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"110\",\"Route\":\"12\",\"VehicleCode\":\"2741\",\"VehicleService\":\"110-01\",\"VehicleId\":145598,\"Speed\":0,\"Delay\":193,\"Lat\":54.38190841674805,\"Lon\":18.597200393676758,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:28\",\"Line\":\"8\",\"Route\":\"12\",\"VehicleCode\":\"1035\",\"VehicleService\":\"008-06\",\"VehicleId\":442,\"Speed\":0,\"Delay\":30,\"Lat\":54.38996887207031,\"Lon\":18.608280181884766,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:26\",\"Line\":\"168\",\"Route\":\"12\",\"VehicleCode\":\"2777\",\"VehicleService\":\"168-03\",\"VehicleId\":145713,\"Speed\":10,\"Delay\":384,\"Lat\":54.35935974121094,\"Lon\":18.604570388793945,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:20\",\"Line\":\"6\",\"Route\":\"52\",\"VehicleCode\":\"1031\",\"VehicleService\":\"006-05\",\"VehicleId\":425,\"Speed\":35,\"Delay\":13,\"Lat\":54.358551025390625,\"Lon\":18.64543914794922,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:28\",\"Line\":\"12\",\"Route\":\"31\",\"VehicleCode\":\"1150\",\"VehicleService\":\"012-04\",\"VehicleId\":501,\"Speed\":55,\"Delay\":-19,\"Lat\":54.38426971435547,\"Lon\":18.59568977355957,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"3\",\"Route\":\"12\",\"VehicleCode\":\"1124\",\"VehicleService\":\"003-03\",\"VehicleId\":399,\"Speed\":0,\"Delay\":-50,\"Lat\":54.353851318359375,\"Lon\":18.645280838012695,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:29\",\"Line\":\"227\",\"Route\":\"12\",\"VehicleCode\":\"2526\",\"VehicleService\":\"227-03\",\"VehicleId\":192,\"Speed\":0,\"Delay\":152,\"Lat\":54.364200592041016,\"Lon\":18.57352066040039,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:30\",\"Line\":\"158\",\"Route\":\"11\",\"VehicleCode\":\"2806\",\"VehicleService\":\"158-01\",\"VehicleId\":183,\"Speed\":0,\"Delay\":-30,\"Lat\":54.36085891723633,\"Lon\":18.69194984436035,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:12\",\"Line\":\"12\",\"Route\":\"22\",\"VehicleCode\":\"1058\",\"VehicleService\":\"012-01\",\"VehicleId\":145743,\"Speed\":0,\"Delay\":-50,\"Lat\":54.363868713378906,\"Lon\":18.63861083984375,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:04\",\"Line\":\"168\",\"Route\":\"11\",\"VehicleCode\":\"2732\",\"VehicleService\":\"168-02\",\"VehicleId\":463,\"Speed\":35,\"Delay\":-23,\"Lat\":54.37725067138672,\"Lon\":18.61018943786621,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:29\",\"Line\":\"112\",\"Route\":\"12\",\"VehicleCode\":\"2681\",\"VehicleService\":\"112-04\",\"VehicleId\":145734,\"Speed\":0,\"Delay\":0,\"Lat\":54.36164855957031,\"Lon\":18.64566993713379,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:13\",\"Line\":\"6\",\"Route\":\"61\",\"VehicleCode\":\"1001\",\"VehicleService\":\"006-12\",\"VehicleId\":267,\"Speed\":15,\"Delay\":44,\"Lat\":54.32387924194336,\"Lon\":18.605670928955078,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:33\",\"Line\":\"158\",\"Route\":\"11\",\"VehicleCode\":\"2094\",\"VehicleService\":\"158-03\",\"VehicleId\":171,\"Speed\":0,\"Delay\":0,\"Lat\":54.38172912597656,\"Lon\":18.604379653930664,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"12\",\"Route\":\"31\",\"VehicleCode\":\"1172\",\"VehicleService\":\"012-03\",\"VehicleId\":141565,\"Speed\":0,\"Delay\":0,\"Lat\":54.4098014831543,\"Lon\":18.567150115966797,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:22\",\"Line\":\"162\",\"Route\":\"12\",\"VehicleCode\":\"2658\",\"VehicleService\":\"162-05\",\"VehicleId\":145591,\"Speed\":0,\"Delay\":139,\"Lat\":54.35226821899414,\"Lon\":18.59174919128418,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:45:57\",\"Line\":\"130\",\"Route\":\"11\",\"VehicleCode\":\"2096\",\"VehicleService\":\"130-04\",\"VehicleId\":173,\"Speed\":0,\"Delay\":0,\"Lat\":54.352909088134766,\"Lon\":18.54962921142578,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:28\",\"Line\":\"110\",\"Route\":\"11\",\"VehicleCode\":\"2742\",\"VehicleService\":\"110-02\",\"VehicleId\":145599,\"Speed\":0,\"Delay\":0,\"Lat\":54.382720947265625,\"Lon\":18.467819213867188,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:26\",\"Line\":\"115\",\"Route\":\"102\",\"VehicleCode\":\"2778\",\"VehicleService\":\"115-07\",\"VehicleId\":145714,\"Speed\":0,\"Delay\":-157,\"Lat\":54.33639907836914,\"Lon\":18.59803009033203,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:22\",\"Line\":\"5\",\"Route\":\"91\",\"VehicleCode\":\"1140\",\"VehicleService\":\"005-07\",\"VehicleId\":276,\"Speed\":20,\"Delay\":-18,\"Lat\":54.40671920776367,\"Lon\":18.6424503326416,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:19\",\"Line\":\"118\",\"Route\":\"101\",\"VehicleCode\":\"2538\",\"VehicleService\":\"118-01\",\"VehicleId\":366,\"Speed\":45,\"Delay\":-31,\"Lat\":54.3307991027832,\"Lon\":18.596649169921875,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:24\",\"Line\":\"6\",\"Route\":\"52\",\"VehicleCode\":\"1016\",\"VehicleService\":\"006-06\",\"VehicleId\":412,\"Speed\":0,\"Delay\":-43,\"Lat\":54.39078903198242,\"Lon\":18.578250885009766,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:12\",\"Line\":\"6\",\"Route\":\"21\",\"VehicleCode\":\"1042\",\"VehicleService\":\"006-18\",\"VehicleId\":454,\"Speed\":0,\"Delay\":-9,\"Lat\":54.38732147216797,\"Lon\":18.5833797454834,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:33\",\"Line\":\"115\",\"Route\":\"101\",\"VehicleCode\":\"2768\",\"VehicleService\":\"115-05\",\"VehicleId\":145704,\"Speed\":55,\"Delay\":130,\"Lat\":54.33185958862305,\"Lon\":18.574880599975586,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"207\",\"Route\":\"12\",\"VehicleCode\":\"8502\",\"VehicleService\":\"207-06\",\"VehicleId\":145638,\"Speed\":10,\"Delay\":90,\"Lat\":54.262821197509766,\"Lon\":18.63627052307129,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:24\",\"Line\":\"6\",\"Route\":\"52\",\"VehicleCode\":\"1041\",\"VehicleService\":\"006-04\",\"VehicleId\":453,\"Speed\":15,\"Delay\":75,\"Lat\":54.34783935546875,\"Lon\":18.64362907409668,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:17\",\"Line\":\"127\",\"Route\":\"41\",\"VehicleCode\":\"2650\",\"VehicleService\":\"127-05\",\"VehicleId\":477,\"Speed\":20,\"Delay\":80,\"Lat\":54.383541107177734,\"Lon\":18.59910011291504,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"T8\",\"Route\":\"11\",\"VehicleCode\":\"9272\",\"VehicleService\":\"808-02\",\"VehicleId\":355,\"Speed\":40,\"Delay\":-19,\"Lat\":54.36111068725586,\"Lon\":18.694169998168945,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"100\",\"Route\":\"32\",\"VehicleCode\":\"2905\",\"VehicleService\":\"100-02\",\"VehicleId\":521,\"Speed\":15,\"Delay\":-28,\"Lat\":54.359378814697266,\"Lon\":18.647520065307617,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"111\",\"Route\":\"12\",\"VehicleCode\":\"2073\",\"VehicleService\":\"111-01\",\"VehicleId\":71,\"Speed\":0,\"Delay\":70,\"Lat\":54.34901809692383,\"Lon\":18.669849395751953,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:16\",\"Line\":\"10\",\"Route\":\"52\",\"VehicleCode\":\"1145\",\"VehicleService\":\"010-05\",\"VehicleId\":484,\"Speed\":5,\"Delay\":-47,\"Lat\":54.37678909301758,\"Lon\":18.63088035583496,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:25\",\"Line\":\"6\",\"Route\":\"21\",\"VehicleCode\":\"1024\",\"VehicleService\":\"006-17\",\"VehicleId\":489,\"Speed\":0,\"Delay\":0,\"Lat\":54.42335891723633,\"Lon\":18.59280014038086,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:13\",\"Line\":\"9\",\"Route\":\"111\",\"VehicleCode\":\"1171\",\"VehicleService\":\"009-02\",\"VehicleId\":141564,\"Speed\":20,\"Delay\":-51,\"Lat\":54.375850677490234,\"Lon\":18.61595916748047,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:33\",\"Line\":\"T8\",\"Route\":\"11\",\"VehicleCode\":\"9281\",\"VehicleService\":\"808-01\",\"VehicleId\":145627,\"Speed\":0,\"Delay\":0,\"Lat\":54.37242889404297,\"Lon\":18.72909927368164,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:30\",\"Line\":\"136\",\"Route\":\"12\",\"VehicleCode\":\"2487\",\"VehicleService\":\"136-01\",\"VehicleId\":145604,\"Speed\":5,\"Delay\":261,\"Lat\":54.38174819946289,\"Lon\":18.596729278564453,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:24\",\"Line\":\"122\",\"Route\":\"32\",\"VehicleCode\":\"8003\",\"VehicleService\":\"122-01\",\"VehicleId\":145661,\"Speed\":0,\"Delay\":0,\"Lat\":54.38309860229492,\"Lon\":18.467439651489258,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:25\",\"Line\":\"115\",\"Route\":\"102\",\"VehicleCode\":\"2098\",\"VehicleService\":\"115-01\",\"VehicleId\":175,\"Speed\":15,\"Delay\":-33,\"Lat\":54.366249084472656,\"Lon\":18.61924934387207,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:16\",\"Line\":\"5\",\"Route\":\"91\",\"VehicleCode\":\"1162\",\"VehicleService\":\"005-08\",\"VehicleId\":141555,\"Speed\":0,\"Delay\":-64,\"Lat\":54.37253952026367,\"Lon\":18.624300003051758,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:12\",\"Line\":\"112\",\"Route\":\"12\",\"VehicleCode\":\"2669\",\"VehicleService\":\"112-01\",\"VehicleId\":145722,\"Speed\":25,\"Delay\":45,\"Lat\":54.343299865722656,\"Lon\":18.825340270996094,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:28\",\"Line\":\"186\",\"Route\":\"71\",\"VehicleCode\":\"2067\",\"VehicleService\":\"186-02\",\"VehicleId\":66,\"Speed\":10,\"Delay\":13,\"Lat\":54.33974838256836,\"Lon\":18.823659896850586,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:21\",\"Line\":\"213\",\"Route\":\"12\",\"VehicleCode\":\"8008\",\"VehicleService\":\"213-01\",\"VehicleId\":145666,\"Speed\":5,\"Delay\":130,\"Lat\":54.3206901550293,\"Lon\":18.596649169921875,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:25\",\"Line\":\"154\",\"Route\":\"12\",\"VehicleCode\":\"2542\",\"VehicleService\":\"154-03\",\"VehicleId\":207,\"Speed\":35,\"Delay\":13,\"Lat\":54.34040832519531,\"Lon\":18.641090393066406,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:33\",\"Line\":\"132\",\"Route\":\"202\",\"VehicleCode\":\"8506\",\"VehicleService\":\"132-02\",\"VehicleId\":145642,\"Speed\":0,\"Delay\":90,\"Lat\":54.32347106933594,\"Lon\":18.6318302154541,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:11\",\"Line\":\"210\",\"Route\":\"302\",\"VehicleCode\":\"2659\",\"VehicleService\":\"210-01\",\"VehicleId\":145592,\"Speed\":50,\"Delay\":154,\"Lat\":54.37630081176758,\"Lon\":18.530790328979492,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:29\",\"Line\":\"283\",\"Route\":\"21\",\"VehicleCode\":\"2904\",\"VehicleService\":\"283-02\",\"VehicleId\":509,\"Speed\":0,\"Delay\":0,\"Lat\":54.396209716796875,\"Lon\":18.67350959777832,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:15\",\"Line\":\"295\",\"Route\":\"21\",\"VehicleCode\":\"2733\",\"VehicleService\":\"295-01\",\"VehicleId\":464,\"Speed\":5,\"Delay\":12,\"Lat\":54.31800842285156,\"Lon\":18.58654022216797,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:25\",\"Line\":\"199\",\"Route\":\"12\",\"VehicleCode\":\"2666\",\"VehicleService\":\"199-05\",\"VehicleId\":145719,\"Speed\":5,\"Delay\":143,\"Lat\":54.35197067260742,\"Lon\":18.644620895385742,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"200\",\"Route\":\"11\",\"VehicleCode\":\"8504\",\"VehicleService\":\"200-03\",\"VehicleId\":145640,\"Speed\":40,\"Delay\":7,\"Lat\":54.260780334472656,\"Lon\":18.648759841918945,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:10\",\"Line\":\"12\",\"Route\":\"22\",\"VehicleCode\":\"1055\",\"VehicleService\":\"012-06\",\"VehicleId\":141540,\"Speed\":0,\"Delay\":0,\"Lat\":54.35279846191406,\"Lon\":18.575950622558594,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:27\",\"Line\":\"227\",\"Route\":\"12\",\"VehicleCode\":\"2531\",\"VehicleService\":\"227-04\",\"VehicleId\":197,\"Speed\":0,\"Delay\":27,\"Lat\":54.337669372558594,\"Lon\":18.626070022583008,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:16\",\"Line\":\"171\",\"Route\":\"22\",\"VehicleCode\":\"8521\",\"VehicleService\":\"171-02\",\"VehicleId\":145657,\"Speed\":20,\"Delay\":52,\"Lat\":54.46900177001953,\"Lon\":18.467830657958984,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:28\",\"Line\":\"167\",\"Route\":\"21\",\"VehicleCode\":\"2675\",\"VehicleService\":\"167-04\",\"VehicleId\":145728,\"Speed\":40,\"Delay\":-19,\"Lat\":54.36119842529297,\"Lon\":18.49217987060547,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"5\",\"Route\":\"91\",\"VehicleCode\":\"1122\",\"VehicleService\":\"005-02\",\"VehicleId\":394,\"Speed\":0,\"Delay\":-88,\"Lat\":54.39992141723633,\"Lon\":18.595659255981445,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:30\",\"Line\":\"178\",\"Route\":\"121\",\"VehicleCode\":\"2745\",\"VehicleService\":\"178-01\",\"VehicleId\":145602,\"Speed\":5,\"Delay\":90,\"Lat\":54.32939147949219,\"Lon\":18.683990478515625,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:28\",\"Line\":\"115\",\"Route\":\"102\",\"VehicleCode\":\"2774\",\"VehicleService\":\"115-06\",\"VehicleId\":145710,\"Speed\":5,\"Delay\":0,\"Lat\":54.3178596496582,\"Lon\":18.56926918029785,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:33\",\"Line\":\"127\",\"Route\":\"41\",\"VehicleCode\":\"2672\",\"VehicleService\":\"127-06\",\"VehicleId\":145725,\"Speed\":0,\"Delay\":8,\"Lat\":54.40830993652344,\"Lon\":18.588390350341797,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"127\",\"Route\":\"122\",\"VehicleCode\":\"2665\",\"VehicleService\":\"127-01\",\"VehicleId\":145718,\"Speed\":0,\"Delay\":91,\"Lat\":54.40766143798828,\"Lon\":18.61383056640625,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:33\",\"Line\":\"3\",\"Route\":\"11\",\"VehicleCode\":\"1114\",\"VehicleService\":\"003-01\",\"VehicleId\":273,\"Speed\":35,\"Delay\":-22,\"Lat\":54.39255905151367,\"Lon\":18.622360229492188,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"227\",\"Route\":\"12\",\"VehicleCode\":\"2524\",\"VehicleService\":\"227-02\",\"VehicleId\":190,\"Speed\":40,\"Delay\":399,\"Lat\":54.40205001831055,\"Lon\":18.59217071533203,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:26\",\"Line\":\"9\",\"Route\":\"111\",\"VehicleCode\":\"1165\",\"VehicleService\":\"009-06\",\"VehicleId\":141558,\"Speed\":0,\"Delay\":0,\"Lat\":54.36138153076172,\"Lon\":18.707420349121094,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"199\",\"Route\":\"12\",\"VehicleCode\":\"2530\",\"VehicleService\":\"199-03\",\"VehicleId\":196,\"Speed\":0,\"Delay\":203,\"Lat\":54.406341552734375,\"Lon\":18.604759216308594,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:22\",\"Line\":\"199\",\"Route\":\"12\",\"VehicleCode\":\"2673\",\"VehicleService\":\"199-04\",\"VehicleId\":145726,\"Speed\":10,\"Delay\":133,\"Lat\":54.37696838378906,\"Lon\":18.615280151367188,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:33\",\"Line\":\"115\",\"Route\":\"101\",\"VehicleCode\":\"2764\",\"VehicleService\":\"115-04\",\"VehicleId\":145700,\"Speed\":20,\"Delay\":22,\"Lat\":54.361289978027344,\"Lon\":18.613710403442383,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:27\",\"Line\":\"227\",\"Route\":\"21\",\"VehicleCode\":\"2680\",\"VehicleService\":\"227-01\",\"VehicleId\":145733,\"Speed\":5,\"Delay\":23,\"Lat\":54.42329025268555,\"Lon\":18.59351921081543,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:33\",\"Line\":\"111\",\"Route\":\"12\",\"VehicleCode\":\"2805\",\"VehicleService\":\"111-03\",\"VehicleId\":182,\"Speed\":0,\"Delay\":0,\"Lat\":54.361480712890625,\"Lon\":18.645469665527344,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:23\",\"Line\":\"124\",\"Route\":\"12\",\"VehicleCode\":\"2092\",\"VehicleService\":\"124-01\",\"VehicleId\":169,\"Speed\":0,\"Delay\":0,\"Lat\":54.381038665771484,\"Lon\":18.606229782104492,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:29\",\"Line\":\"12\",\"Route\":\"22\",\"VehicleCode\":\"1054\",\"VehicleService\":\"012-07\",\"VehicleId\":141539,\"Speed\":10,\"Delay\":-152,\"Lat\":54.35580825805664,\"Lon\":18.588300704956055,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:22\",\"Line\":\"127\",\"Route\":\"122\",\"VehicleCode\":\"2536\",\"VehicleService\":\"127-03\",\"VehicleId\":202,\"Speed\":25,\"Delay\":3,\"Lat\":54.352298736572266,\"Lon\":18.549699783325195,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:30\",\"Line\":\"6\",\"Route\":\"52\",\"VehicleCode\":\"1027\",\"VehicleService\":\"006-07\",\"VehicleId\":421,\"Speed\":20,\"Delay\":-24,\"Lat\":54.421791076660156,\"Lon\":18.58871078491211,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:21\",\"Line\":\"5\",\"Route\":\"42\",\"VehicleCode\":\"1012\",\"VehicleService\":\"005-05\",\"VehicleId\":408,\"Speed\":10,\"Delay\":72,\"Lat\":54.37268829345703,\"Lon\":18.623760223388672,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"210\",\"Route\":\"301\",\"VehicleCode\":\"2661\",\"VehicleService\":\"210-02\",\"VehicleId\":145594,\"Speed\":35,\"Delay\":83,\"Lat\":54.38282012939453,\"Lon\":18.4743595123291,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"199\",\"Route\":\"201\",\"VehicleCode\":\"2652\",\"VehicleService\":\"199-06\",\"VehicleId\":474,\"Speed\":0,\"Delay\":0,\"Lat\":54.36157989501953,\"Lon\":18.64579963684082,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:45:40\",\"Line\":\"205\",\"Route\":\"101\",\"VehicleCode\":\"8511\",\"VehicleService\":\"205-04\",\"VehicleId\":145647,\"Speed\":0,\"Delay\":88,\"Lat\":54.345951080322266,\"Lon\":18.645240783691406,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:24\",\"Line\":\"186\",\"Route\":\"52\",\"VehicleCode\":\"2735\",\"VehicleService\":\"186-03\",\"VehicleId\":466,\"Speed\":0,\"Delay\":0,\"Lat\":54.36140823364258,\"Lon\":18.646129608154297,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:22\",\"Line\":\"112\",\"Route\":\"61\",\"VehicleCode\":\"2668\",\"VehicleService\":\"112-03\",\"VehicleId\":145721,\"Speed\":0,\"Delay\":88,\"Lat\":54.34901809692383,\"Lon\":18.67378044128418,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"12\",\"Route\":\"31\",\"VehicleCode\":\"1057\",\"VehicleService\":\"012-05\",\"VehicleId\":145742,\"Speed\":0,\"Delay\":-34,\"Lat\":54.351871490478516,\"Lon\":18.64565086364746,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:28\",\"Line\":\"175\",\"Route\":\"72\",\"VehicleCode\":\"2770\",\"VehicleService\":\"175-03\",\"VehicleId\":145706,\"Speed\":10,\"Delay\":0,\"Lat\":54.306949615478516,\"Lon\":18.61467933654785,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:19\",\"Line\":\"162\",\"Route\":\"12\",\"VehicleCode\":\"2522\",\"VehicleService\":\"162-01\",\"VehicleId\":188,\"Speed\":10,\"Delay\":13,\"Lat\":54.32482147216797,\"Lon\":18.6185302734375,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:28\",\"Line\":\"162\",\"Route\":\"31\",\"VehicleCode\":\"2682\",\"VehicleService\":\"162-02\",\"VehicleId\":145735,\"Speed\":25,\"Delay\":184,\"Lat\":54.32522964477539,\"Lon\":18.613840103149414,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:21\",\"Line\":\"126\",\"Route\":\"12\",\"VehicleCode\":\"8509\",\"VehicleService\":\"126-01\",\"VehicleId\":145645,\"Speed\":30,\"Delay\":5,\"Lat\":54.37617111206055,\"Lon\":18.511539459228516,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:29\",\"Line\":\"154\",\"Route\":\"12\",\"VehicleCode\":\"2516\",\"VehicleService\":\"154-02\",\"VehicleId\":105,\"Speed\":0,\"Delay\":0,\"Lat\":54.361568450927734,\"Lon\":18.645809173583984,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:25\",\"Line\":\"126\",\"Route\":\"31\",\"VehicleCode\":\"8004\",\"VehicleService\":\"126-02\",\"VehicleId\":145662,\"Speed\":45,\"Delay\":174,\"Lat\":54.37654113769531,\"Lon\":18.520370483398438,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"9\",\"Route\":\"112\",\"VehicleCode\":\"1163\",\"VehicleService\":\"009-03\",\"VehicleId\":141556,\"Speed\":0,\"Delay\":636,\"Lat\":54.391319274902344,\"Lon\":18.578519821166992,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:11\",\"Line\":\"8\",\"Route\":\"11\",\"VehicleCode\":\"1033\",\"VehicleService\":\"008-02\",\"VehicleId\":443,\"Speed\":10,\"Delay\":60,\"Lat\":54.35765075683594,\"Lon\":18.6459903717041,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:20\",\"Line\":\"179\",\"Route\":\"121\",\"VehicleCode\":\"2528\",\"VehicleService\":\"179-02\",\"VehicleId\":194,\"Speed\":0,\"Delay\":26,\"Lat\":54.40813064575195,\"Lon\":18.559629440307617,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:22\",\"Line\":\"189\",\"Route\":\"11\",\"VehicleCode\":\"2078\",\"VehicleService\":\"189-21\",\"VehicleId\":76,\"Speed\":0,\"Delay\":44,\"Lat\":54.352359771728516,\"Lon\":18.645919799804688,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:30\",\"Line\":\"6\",\"Route\":\"52\",\"VehicleCode\":\"1034\",\"VehicleService\":\"006-16\",\"VehicleId\":440,\"Speed\":20,\"Delay\":281,\"Lat\":54.42042922973633,\"Lon\":18.584489822387695,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:30\",\"Line\":\"5\",\"Route\":\"91\",\"VehicleCode\":\"1111\",\"VehicleService\":\"005-01\",\"VehicleId\":520,\"Speed\":5,\"Delay\":-39,\"Lat\":54.407920837402344,\"Lon\":18.563079833984375,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:30\",\"Line\":\"167\",\"Route\":\"32\",\"VehicleCode\":\"2684\",\"VehicleService\":\"167-02\",\"VehicleId\":145737,\"Speed\":10,\"Delay\":329,\"Lat\":54.3488883972168,\"Lon\":18.61907958984375,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"189\",\"Route\":\"12\",\"VehicleCode\":\"2070\",\"VehicleService\":\"189-02\",\"VehicleId\":505,\"Speed\":15,\"Delay\":0,\"Lat\":54.3613395690918,\"Lon\":18.64533042907715,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"10\",\"Route\":\"21\",\"VehicleCode\":\"1139\",\"VehicleService\":\"010-01\",\"VehicleId\":325,\"Speed\":10,\"Delay\":132,\"Lat\":54.36505126953125,\"Lon\":18.57386016845703,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:24\",\"Line\":\"8\",\"Route\":\"12\",\"VehicleCode\":\"1039\",\"VehicleService\":\"008-05\",\"VehicleId\":446,\"Speed\":0,\"Delay\":0,\"Lat\":54.42308044433594,\"Lon\":18.59246063232422,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:25\",\"Line\":\"174\",\"Route\":\"112\",\"VehicleCode\":\"8006\",\"VehicleService\":\"174-01\",\"VehicleId\":145664,\"Speed\":15,\"Delay\":32,\"Lat\":54.32447052001953,\"Lon\":18.516759872436523,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:28\",\"Line\":\"148\",\"Route\":\"22\",\"VehicleCode\":\"2685\",\"VehicleService\":\"148-01\",\"VehicleId\":145738,\"Speed\":25,\"Delay\":126,\"Lat\":54.410648345947266,\"Lon\":18.60498046875,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"2\",\"Route\":\"12\",\"VehicleCode\":\"1015\",\"VehicleService\":\"002-04\",\"VehicleId\":406,\"Speed\":15,\"Delay\":32,\"Lat\":54.4126091003418,\"Lon\":18.587810516357422,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:11\",\"Line\":\"199\",\"Route\":\"201\",\"VehicleCode\":\"2656\",\"VehicleService\":\"199-08\",\"VehicleId\":145589,\"Speed\":25,\"Delay\":157,\"Lat\":54.38106155395508,\"Lon\":18.60565948486328,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:23\",\"Line\":\"132\",\"Route\":\"221\",\"VehicleCode\":\"8512\",\"VehicleService\":\"132-01\",\"VehicleId\":145648,\"Speed\":15,\"Delay\":-52,\"Lat\":54.24855041503906,\"Lon\":18.63344955444336,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:29\",\"Line\":\"12\",\"Route\":\"22\",\"VehicleCode\":\"1164\",\"VehicleService\":\"012-02\",\"VehicleId\":141557,\"Speed\":0,\"Delay\":30,\"Lat\":54.39936065673828,\"Lon\":18.56814956665039,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:19\",\"Line\":\"155\",\"Route\":\"11\",\"VehicleCode\":\"2769\",\"VehicleService\":\"155-02\",\"VehicleId\":145705,\"Speed\":5,\"Delay\":196,\"Lat\":54.342010498046875,\"Lon\":18.55324935913086,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"167\",\"Route\":\"21\",\"VehicleCode\":\"2676\",\"VehicleService\":\"167-01\",\"VehicleId\":145729,\"Speed\":0,\"Delay\":138,\"Lat\":54.3519287109375,\"Lon\":18.64388084411621,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:44:09\",\"Line\":\"189\",\"Route\":\"\",\"VehicleCode\":\"2803\",\"VehicleService\":\"189-01\",\"VehicleId\":180,\"Speed\":45,\"Delay\":11,\"Lat\":54.309181213378906,\"Lon\":18.61457061767578,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:33\",\"Line\":\"249\",\"Route\":\"111\",\"VehicleCode\":\"2488\",\"VehicleService\":\"249-01\",\"VehicleId\":145605,\"Speed\":15,\"Delay\":105,\"Lat\":54.3851203918457,\"Lon\":18.60590934753418,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:44:34\",\"Line\":\"199\",\"Route\":\"12\",\"VehicleCode\":\"2664\",\"VehicleService\":\"199-02\",\"VehicleId\":145717,\"Speed\":0,\"Delay\":0,\"Lat\":54.41122817993164,\"Lon\":18.572290420532227,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:26\",\"Line\":\"169\",\"Route\":\"32\",\"VehicleCode\":\"2523\",\"VehicleService\":\"169-03\",\"VehicleId\":189,\"Speed\":40,\"Delay\":-83,\"Lat\":54.43069076538086,\"Lon\":18.474870681762695,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:18\",\"Line\":\"199\",\"Route\":\"201\",\"VehicleCode\":\"2674\",\"VehicleService\":\"199-01\",\"VehicleId\":145727,\"Speed\":30,\"Delay\":68,\"Lat\":54.40605163574219,\"Lon\":18.60287094116211,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:33\",\"Line\":\"122\",\"Route\":\"31\",\"VehicleCode\":\"8013\",\"VehicleService\":\"122-02\",\"VehicleId\":145671,\"Speed\":0,\"Delay\":-30,\"Lat\":54.44231033325195,\"Lon\":18.571170806884766,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:19\",\"Line\":\"6\",\"Route\":\"52\",\"VehicleCode\":\"1028\",\"VehicleService\":\"006-13\",\"VehicleId\":422,\"Speed\":35,\"Delay\":4,\"Lat\":54.331939697265625,\"Lon\":18.596410751342773,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:25\",\"Line\":\"127\",\"Route\":\"41\",\"VehicleCode\":\"2647\",\"VehicleService\":\"127-04\",\"VehicleId\":473,\"Speed\":45,\"Delay\":0,\"Lat\":54.352630615234375,\"Lon\":18.54998016357422,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:27\",\"Line\":\"2\",\"Route\":\"12\",\"VehicleCode\":\"1017\",\"VehicleService\":\"002-03\",\"VehicleId\":411,\"Speed\":10,\"Delay\":325,\"Lat\":54.3827018737793,\"Lon\":18.62187957763672,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"155\",\"Route\":\"12\",\"VehicleCode\":\"2776\",\"VehicleService\":\"155-01\",\"VehicleId\":145712,\"Speed\":30,\"Delay\":129,\"Lat\":54.32352066040039,\"Lon\":18.555999755859375,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:23\",\"Line\":\"2\",\"Route\":\"11\",\"VehicleCode\":\"1036\",\"VehicleService\":\"002-08\",\"VehicleId\":445,\"Speed\":55,\"Delay\":-13,\"Lat\":54.347389221191406,\"Lon\":18.632680892944336,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:27\",\"Line\":\"10\",\"Route\":\"21\",\"VehicleCode\":\"1115\",\"VehicleService\":\"010-02\",\"VehicleId\":323,\"Speed\":0,\"Delay\":-35,\"Lat\":54.34925842285156,\"Lon\":18.624300003051758,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:23\",\"Line\":\"148\",\"Route\":\"22\",\"VehicleCode\":\"2671\",\"VehicleService\":\"148-04\",\"VehicleId\":145724,\"Speed\":0,\"Delay\":0,\"Lat\":54.39630889892578,\"Lon\":18.673479080200195,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:28\",\"Line\":\"175\",\"Route\":\"72\",\"VehicleCode\":\"2737\",\"VehicleService\":\"175-02\",\"VehicleId\":468,\"Speed\":10,\"Delay\":26,\"Lat\":54.32915115356445,\"Lon\":18.59847068786621,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:17\",\"Line\":\"123\",\"Route\":\"52\",\"VehicleCode\":\"2763\",\"VehicleService\":\"123-01\",\"VehicleId\":145699,\"Speed\":35,\"Delay\":-50,\"Lat\":54.33415985107422,\"Lon\":18.65428924560547,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"148\",\"Route\":\"11\",\"VehicleCode\":\"2663\",\"VehicleService\":\"148-03\",\"VehicleId\":145716,\"Speed\":20,\"Delay\":-29,\"Lat\":54.40169143676758,\"Lon\":18.65838050842285,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"120\",\"Route\":\"12\",\"VehicleCode\":\"2766\",\"VehicleService\":\"120-02\",\"VehicleId\":145702,\"Speed\":10,\"Delay\":26,\"Lat\":54.333641052246094,\"Lon\":18.54153060913086,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:30\",\"Line\":\"255\",\"Route\":\"31\",\"VehicleCode\":\"8015\",\"VehicleService\":\"255-01\",\"VehicleId\":145673,\"Speed\":15,\"Delay\":41,\"Lat\":54.30913162231445,\"Lon\":18.560829162597656,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"283\",\"Route\":\"62\",\"VehicleCode\":\"2708\",\"VehicleService\":\"283-01\",\"VehicleId\":149,\"Speed\":25,\"Delay\":-125,\"Lat\":54.3734016418457,\"Lon\":18.562170028686523,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"210\",\"Route\":\"302\",\"VehicleCode\":\"2657\",\"VehicleService\":\"210-03\",\"VehicleId\":145590,\"Speed\":0,\"Delay\":0,\"Lat\":54.322898864746094,\"Lon\":18.632110595703125,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:30\",\"Line\":\"6\",\"Route\":\"21\",\"VehicleCode\":\"1014\",\"VehicleService\":\"006-08\",\"VehicleId\":404,\"Speed\":20,\"Delay\":-56,\"Lat\":54.40652847290039,\"Lon\":18.56348991394043,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:19\",\"Line\":\"130\",\"Route\":\"32\",\"VehicleCode\":\"2740\",\"VehicleService\":\"130-03\",\"VehicleId\":145597,\"Speed\":0,\"Delay\":76,\"Lat\":54.3584098815918,\"Lon\":18.587400436401367,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:15\",\"Line\":\"184\",\"Route\":\"31\",\"VehicleCode\":\"2077\",\"VehicleService\":\"184-02\",\"VehicleId\":75,\"Speed\":10,\"Delay\":-48,\"Lat\":54.355899810791016,\"Lon\":18.61216926574707,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:28\",\"Line\":\"8\",\"Route\":\"11\",\"VehicleCode\":\"1044\",\"VehicleService\":\"008-01\",\"VehicleId\":479,\"Speed\":0,\"Delay\":0,\"Lat\":54.357521057128906,\"Lon\":18.684280395507812,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:22\",\"Line\":\"199\",\"Route\":\"201\",\"VehicleCode\":\"2643\",\"VehicleService\":\"199-07\",\"VehicleId\":461,\"Speed\":10,\"Delay\":71,\"Lat\":54.351539611816406,\"Lon\":18.639659881591797,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"131\",\"Route\":\"11\",\"VehicleCode\":\"2489\",\"VehicleService\":\"131-01\",\"VehicleId\":145606,\"Speed\":0,\"Delay\":257,\"Lat\":54.34727096557617,\"Lon\":18.64566993713379,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:29\",\"Line\":\"143\",\"Route\":\"11\",\"VehicleCode\":\"8007\",\"VehicleService\":\"143-02\",\"VehicleId\":145665,\"Speed\":5,\"Delay\":89,\"Lat\":54.43933868408203,\"Lon\":18.564210891723633,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:33\",\"Line\":\"107\",\"Route\":\"72\",\"VehicleCode\":\"8012\",\"VehicleService\":\"107-01\",\"VehicleId\":145670,\"Speed\":0,\"Delay\":33,\"Lat\":54.2582893371582,\"Lon\":18.633249282836914,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:30\",\"Line\":\"9\",\"Route\":\"112\",\"VehicleCode\":\"1151\",\"VehicleService\":\"009-05\",\"VehicleId\":491,\"Speed\":35,\"Delay\":38,\"Lat\":54.34471893310547,\"Lon\":18.664749145507812,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"210\",\"Route\":\"301\",\"VehicleCode\":\"2653\",\"VehicleService\":\"210-21\",\"VehicleId\":145586,\"Speed\":0,\"Delay\":0,\"Lat\":54.42095184326172,\"Lon\":18.452369689941406,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:10\",\"Line\":\"3\",\"Route\":\"12\",\"VehicleCode\":\"1037\",\"VehicleService\":\"003-02\",\"VehicleId\":441,\"Speed\":5,\"Delay\":-55,\"Lat\":54.39657974243164,\"Lon\":18.622379302978516,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:23\",\"Line\":\"184\",\"Route\":\"12\",\"VehicleCode\":\"2802\",\"VehicleService\":\"184-01\",\"VehicleId\":179,\"Speed\":0,\"Delay\":23,\"Lat\":54.37355041503906,\"Lon\":18.568260192871094,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:12\",\"Line\":\"5\",\"Route\":\"42\",\"VehicleCode\":\"1147\",\"VehicleService\":\"005-04\",\"VehicleId\":482,\"Speed\":10,\"Delay\":14,\"Lat\":54.4098014831543,\"Lon\":18.5657901763916,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"168\",\"Route\":\"12\",\"VehicleCode\":\"2081\",\"VehicleService\":\"168-04\",\"VehicleId\":79,\"Speed\":40,\"Delay\":-22,\"Lat\":54.34756088256836,\"Lon\":18.5273494720459,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:26\",\"Line\":\"162\",\"Route\":\"31\",\"VehicleCode\":\"2683\",\"VehicleService\":\"162-03\",\"VehicleId\":145736,\"Speed\":5,\"Delay\":84,\"Lat\":54.36056137084961,\"Lon\":18.58953094482422,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:26\",\"Line\":\"256\",\"Route\":\"22\",\"VehicleCode\":\"8503\",\"VehicleService\":\"256-07\",\"VehicleId\":145639,\"Speed\":30,\"Delay\":-60,\"Lat\":54.330299377441406,\"Lon\":18.62812042236328,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"148\",\"Route\":\"11\",\"VehicleCode\":\"2514\",\"VehicleService\":\"148-02\",\"VehicleId\":103,\"Speed\":0,\"Delay\":205,\"Lat\":54.41320037841797,\"Lon\":18.587989807128906,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"158\",\"Route\":\"12\",\"VehicleCode\":\"2730\",\"VehicleService\":\"158-02\",\"VehicleId\":457,\"Speed\":10,\"Delay\":204,\"Lat\":54.39002990722656,\"Lon\":18.594100952148438,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:11\",\"Line\":\"186\",\"Route\":\"52\",\"VehicleCode\":\"2678\",\"VehicleService\":\"186-01\",\"VehicleId\":145731,\"Speed\":40,\"Delay\":179,\"Lat\":54.34008026123047,\"Lon\":18.734100341796875,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"227\",\"Route\":\"21\",\"VehicleCode\":\"2687\",\"VehicleService\":\"227-05\",\"VehicleId\":145740,\"Speed\":0,\"Delay\":62,\"Lat\":54.34770965576172,\"Lon\":18.60247039794922,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:29\",\"Line\":\"205\",\"Route\":\"102\",\"VehicleCode\":\"8519\",\"VehicleService\":\"205-07\",\"VehicleId\":145655,\"Speed\":30,\"Delay\":17,\"Lat\":54.248291015625,\"Lon\":18.64971923828125,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"6\",\"Route\":\"21\",\"VehicleCode\":\"1005\",\"VehicleService\":\"006-01\",\"VehicleId\":377,\"Speed\":20,\"Delay\":197,\"Lat\":54.362579345703125,\"Lon\":18.640840530395508,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:28\",\"Line\":\"213\",\"Route\":\"12\",\"VehicleCode\":\"2493\",\"VehicleService\":\"213-02\",\"VehicleId\":145696,\"Speed\":0,\"Delay\":0,\"Lat\":54.30550003051758,\"Lon\":18.58111000061035,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:21\",\"Line\":\"118\",\"Route\":\"102\",\"VehicleCode\":\"2686\",\"VehicleService\":\"118-03\",\"VehicleId\":145739,\"Speed\":5,\"Delay\":199,\"Lat\":54.33811950683594,\"Lon\":18.62055015563965,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:22\",\"Line\":\"2\",\"Route\":\"11\",\"VehicleCode\":\"1026\",\"VehicleService\":\"002-07\",\"VehicleId\":420,\"Speed\":35,\"Delay\":-55,\"Lat\":54.382240295410156,\"Lon\":18.6218204498291,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:25\",\"Line\":\"9\",\"Route\":\"111\",\"VehicleCode\":\"1052\",\"VehicleService\":\"009-01\",\"VehicleId\":141537,\"Speed\":40,\"Delay\":-29,\"Lat\":54.34756851196289,\"Lon\":18.66938018798828,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:33\",\"Line\":\"157\",\"Route\":\"21\",\"VehicleCode\":\"2762\",\"VehicleService\":\"157-01\",\"VehicleId\":145698,\"Speed\":0,\"Delay\":0,\"Lat\":54.37506103515625,\"Lon\":18.463550567626953,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:20\",\"Line\":\"118\",\"Route\":\"102\",\"VehicleCode\":\"2546\",\"VehicleService\":\"118-02\",\"VehicleId\":211,\"Speed\":0,\"Delay\":0,\"Lat\":54.361488342285156,\"Lon\":18.645410537719727,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:22\",\"Line\":\"116\",\"Route\":\"11\",\"VehicleCode\":\"2491\",\"VehicleService\":\"116-01\",\"VehicleId\":145626,\"Speed\":10,\"Delay\":-34,\"Lat\":54.36540985107422,\"Lon\":18.57238006591797,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:24\",\"Line\":\"168\",\"Route\":\"11\",\"VehicleCode\":\"2091\",\"VehicleService\":\"168-01\",\"VehicleId\":89,\"Speed\":5,\"Delay\":-38,\"Lat\":54.34054946899414,\"Lon\":18.559070587158203,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:26\",\"Line\":\"2\",\"Route\":\"11\",\"VehicleCode\":\"1040\",\"VehicleService\":\"002-06\",\"VehicleId\":447,\"Speed\":0,\"Delay\":-29,\"Lat\":54.419830322265625,\"Lon\":18.582460403442383,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:15\",\"Line\":\"227\",\"Route\":\"21\",\"VehicleCode\":\"2521\",\"VehicleService\":\"227-06\",\"VehicleId\":187,\"Speed\":25,\"Delay\":42,\"Lat\":54.37998962402344,\"Lon\":18.589599609375,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:26\",\"Line\":\"6\",\"Route\":\"21\",\"VehicleCode\":\"1023\",\"VehicleService\":\"006-02\",\"VehicleId\":417,\"Speed\":30,\"Delay\":-27,\"Lat\":54.33824920654297,\"Lon\":18.60972023010254,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:26\",\"Line\":\"2\",\"Route\":\"12\",\"VehicleCode\":\"1045\",\"VehicleService\":\"002-02\",\"VehicleId\":480,\"Speed\":15,\"Delay\":-28,\"Lat\":54.33824157714844,\"Lon\":18.610689163208008,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"184\",\"Route\":\"12\",\"VehicleCode\":\"2773\",\"VehicleService\":\"184-03\",\"VehicleId\":145709,\"Speed\":0,\"Delay\":0,\"Lat\":54.36146926879883,\"Lon\":18.645780563354492,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:15\",\"Line\":\"3\",\"Route\":\"11\",\"VehicleCode\":\"1127\",\"VehicleService\":\"003-05\",\"VehicleId\":384,\"Speed\":0,\"Delay\":67,\"Lat\":54.35026168823242,\"Lon\":18.646039962768555,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"117\",\"Route\":\"42\",\"VehicleCode\":\"8002\",\"VehicleService\":\"117-01\",\"VehicleId\":145660,\"Speed\":25,\"Delay\":2410,\"Lat\":54.44306945800781,\"Lon\":18.556459426879883,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:28\",\"Line\":\"130\",\"Route\":\"11\",\"VehicleCode\":\"2775\",\"VehicleService\":\"130-01\",\"VehicleId\":145711,\"Speed\":35,\"Delay\":188,\"Lat\":54.3560791015625,\"Lon\":18.60079002380371,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:27\",\"Line\":\"5\",\"Route\":\"42\",\"VehicleCode\":\"1134\",\"VehicleService\":\"005-06\",\"VehicleId\":400,\"Speed\":35,\"Delay\":-85,\"Lat\":54.4069709777832,\"Lon\":18.641529083251953,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:22\",\"Line\":\"154\",\"Route\":\"21\",\"VehicleCode\":\"2648\",\"VehicleService\":\"154-04\",\"VehicleId\":475,\"Speed\":15,\"Delay\":47,\"Lat\":54.32501983642578,\"Lon\":18.620349884033203,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:22\",\"Line\":\"112\",\"Route\":\"61\",\"VehicleCode\":\"2655\",\"VehicleService\":\"112-02\",\"VehicleId\":145588,\"Speed\":15,\"Delay\":86,\"Lat\":54.3347282409668,\"Lon\":18.934310913085938,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:23\",\"Line\":\"143\",\"Route\":\"42\",\"VehicleCode\":\"8005\",\"VehicleService\":\"143-01\",\"VehicleId\":145663,\"Speed\":10,\"Delay\":80,\"Lat\":54.41603088378906,\"Lon\":18.585750579833984,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:21\",\"Line\":\"108\",\"Route\":\"132\",\"VehicleCode\":\"2908\",\"VehicleService\":\"108-01\",\"VehicleId\":524,\"Speed\":20,\"Delay\":172,\"Lat\":54.34016036987305,\"Lon\":18.608999252319336,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:22\",\"Line\":\"127\",\"Route\":\"122\",\"VehicleCode\":\"2520\",\"VehicleService\":\"127-02\",\"VehicleId\":186,\"Speed\":40,\"Delay\":208,\"Lat\":54.370479583740234,\"Lon\":18.597349166870117,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:14\",\"Line\":\"171\",\"Route\":\"22\",\"VehicleCode\":\"8516\",\"VehicleService\":\"171-01\",\"VehicleId\":145652,\"Speed\":5,\"Delay\":66,\"Lat\":54.410221099853516,\"Lon\":18.565959930419922,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:33\",\"Line\":\"213\",\"Route\":\"11\",\"VehicleCode\":\"2490\",\"VehicleService\":\"213-03\",\"VehicleId\":145625,\"Speed\":30,\"Delay\":43,\"Lat\":54.320491790771484,\"Lon\":18.595779418945312,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"8\",\"Route\":\"12\",\"VehicleCode\":\"1118\",\"VehicleService\":\"008-04\",\"VehicleId\":392,\"Speed\":0,\"Delay\":0,\"Lat\":54.423309326171875,\"Lon\":18.592819213867188,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:25\",\"Line\":\"6\",\"Route\":\"61\",\"VehicleCode\":\"1002\",\"VehicleService\":\"006-11\",\"VehicleId\":268,\"Speed\":0,\"Delay\":18,\"Lat\":54.35575866699219,\"Lon\":18.64566993713379,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:31\",\"Line\":\"10\",\"Route\":\"21\",\"VehicleCode\":\"1121\",\"VehicleService\":\"010-03\",\"VehicleId\":387,\"Speed\":35,\"Delay\":-45,\"Lat\":54.38492965698242,\"Lon\":18.64282989501953,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:32\",\"Line\":\"10\",\"Route\":\"52\",\"VehicleCode\":\"1133\",\"VehicleService\":\"010-06\",\"VehicleId\":303,\"Speed\":15,\"Delay\":44,\"Lat\":54.34761047363281,\"Lon\":18.602760314941406,\"GPSQuality\":3},{\"DataGenerated\":\"2020-01-18 16:46:17\",\"Line\":\"130\",\"Route\":\"11\",\"VehicleCode\":\"2744\",\"VehicleService\":\"130-02\",\"VehicleId\":145601,\"Speed\":15,\"Delay\":15,\"Lat\":54.35771942138672,\"Lon\":18.658470153808594,\"GPSQuality\":3}]}");

        stopTextView.setText(getIntent().getStringExtra(new Constants().getCURRENT_STOP_NAME()));

        activityButton.setVisibility(View.INVISIBLE);

        themeSwitch.setChecked(getIntent().getBooleanExtra(new Constants().getSWITCH_STATE(), false));
        themeSwitch.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
            public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
                startVehicleTrackerActivity();
            }
        });

        map = (MapView) findViewById(R.id.mapView);
        mapOverlayPrinter = new MapOverlayPrinter(getApplicationContext(), map);
        Configuration.getInstance().setUserAgentValue(getApplicationContext().getPackageName());
        IMapController mapController = map.getController();
        mapController.setZoom(15.5);
        GeoPoint startPoint = new GeoPoint(getIntent().getFloatExtra(new Constants().getCURRENT_LOCATION_LAT(), 0), getIntent().getFloatExtra(new Constants().getCURRENT_LOCATION_LON(), 0));
        mapController.setCenter(startPoint);
        map.setMultiTouchControls(true);
        map.setTileSource(TileSourceFactory.MAPNIK);

        mapOverlayPrinter.addStopMarker(new GeoPoint(getIntent().getFloatExtra(new Constants().getCURRENT_LOCATION_LAT(), 0),getIntent().getFloatExtra(new Constants().getCURRENT_LOCATION_LON(),0)));
        mapOverlayPrinter.addVehicleMarker(new GeoPoint(trackedVehicle.getLat(),trackedVehicle.getLon()), trackedVehicle.getLine());

    }

    @Override
    public void onBackPressed()
    {
        startMainActivity();
    }

    public void startVehicleTrackerActivity() {
        Intent intentVTA = new Intent(this, VehicleTrackerActivity.class);

        intentVTA.putExtra(new Constants().getSWITCH_STATE(), themeSwitch.isChecked());
        intentVTA.putExtra(new Constants().getCURRENT_STOP_NAME(), getIntent().getStringExtra(new Constants().getCURRENT_STOP_NAME()));
        intentVTA.putExtra(new Constants().getVEHICLE_CODE(), getIntent().getIntExtra(new Constants().getVEHICLE_CODE(), 0));

        startActivity(intentVTA);
    }

    private void startMainActivity() {
        Intent intentMA = new Intent(this, MainActivity.class);

        intentMA.putExtra(new Constants().getSWITCH_STATE(), themeSwitch.isChecked());

        startActivity(intentMA);
    }
}
